{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"D:/TLCN/138_instructor_account_history_and_payouts/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"D:/TLCN/138_instructor_account_history_and_payouts/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"D:/TLCN/138_instructor_account_history_and_payouts/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"D:/TLCN/138_instructor_account_history_and_payouts/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"D:\\\\TLCN\\\\138_instructor_account_history_and_payouts\\\\client\\\\pages\\\\instructor\\\\course\\\\edit\\\\[slug].js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport InstructorRoute from \"../../../../components/routes/InstructorRoute\";\nimport CourseCreateForm from \"../../../../components/forms/CourseCreateForm\";\nimport Resizer from \"react-image-file-resizer\";\nimport { toast } from \"react-toastify\";\nimport { useRouter } from \"next/router\";\nimport { List, Avatar, Modal } from \"antd\";\nimport { DeleteOutlined } from \"@ant-design/icons\";\nimport UpdateLessonForm from \"../../../../components/forms/UpdateLessonForm\";\nvar Item = List.Item;\n\nvar CourseEdit = function CourseEdit() {\n  _s();\n\n  // state\n  var _useState = useState({\n    name: \"\",\n    description: \"\",\n    price: \"9.99\",\n    uploading: false,\n    paid: true,\n    category: \"\",\n    loading: false,\n    lessons: []\n  }),\n      values = _useState[0],\n      setValues = _useState[1];\n\n  var _useState2 = useState({}),\n      image = _useState2[0],\n      setImage = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      preview = _useState3[0],\n      setPreview = _useState3[1];\n\n  var _useState4 = useState(\"Upload Image\"),\n      uploadButtonText = _useState4[0],\n      setUploadButtonText = _useState4[1]; // state for lessons update\n\n\n  var _useState5 = useState(false),\n      visible = _useState5[0],\n      setVisible = _useState5[1];\n\n  var _useState6 = useState({}),\n      current = _useState6[0],\n      setCurrent = _useState6[1];\n\n  var _useState7 = useState(\"Upload Video\"),\n      uploadVideoButtonText = _useState7[0],\n      setUploadVideoButtonText = _useState7[1];\n\n  var _useState8 = useState(0),\n      progress = _useState8[0],\n      setProgress = _useState8[1];\n\n  var _useState9 = useState(false),\n      uploading = _useState9[0],\n      setUploading = _useState9[1]; // router\n\n\n  var router = useRouter();\n  var slug = router.query.slug;\n  useEffect(function () {\n    loadCourse();\n  }, [slug]);\n\n  var loadCourse = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$axios$get, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return axios.get(\"/api/course/\".concat(slug));\n\n            case 2:\n              _yield$axios$get = _context.sent;\n              data = _yield$axios$get.data;\n              console.log(data);\n              if (data) setValues(data);\n              if (data && data.image) setImage(data.image);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function loadCourse() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleChange = function handleChange(e) {\n    setValues(_objectSpread(_objectSpread({}, values), {}, _defineProperty({}, e.target.name, e.target.value)));\n  };\n\n  var handleImage = function handleImage(e) {\n    var file = e.target.files[0];\n    setPreview(window.URL.createObjectURL(file));\n    setUploadButtonText(file.name);\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      loading: true\n    })); // resize\n\n    Resizer.imageFileResizer(file, 720, 500, \"JPEG\", 100, 0, /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(uri) {\n        var _yield$axios$post, data;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return axios.post(\"/api/course/upload-image\", {\n                  image: uri\n                });\n\n              case 3:\n                _yield$axios$post = _context2.sent;\n                data = _yield$axios$post.data;\n                console.log(\"IMAGE UPLOADED\", data); // set image in the state\n\n                setImage(data);\n                setValues(_objectSpread(_objectSpread({}, values), {}, {\n                  loading: false\n                }));\n                _context2.next = 15;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](0);\n                console.log(_context2.t0);\n                setValues(_objectSpread(_objectSpread({}, values), {}, {\n                  loading: false\n                }));\n                toast(\"Image upload failed. Try later.\");\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 10]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n  };\n\n  var handleImageRemove = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              // console.log(values);\n              setValues(_objectSpread(_objectSpread({}, values), {}, {\n                loading: true\n              }));\n              _context3.next = 4;\n              return axios.post(\"/api/course/remove-image\", {\n                image: image\n              });\n\n            case 4:\n              res = _context3.sent;\n              setImage({});\n              setPreview(\"\");\n              setUploadButtonText(\"Upload Image\");\n              setValues(_objectSpread(_objectSpread({}, values), {}, {\n                loading: false\n              }));\n              _context3.next = 16;\n              break;\n\n            case 11:\n              _context3.prev = 11;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.log(_context3.t0);\n              setValues(_objectSpread(_objectSpread({}, values), {}, {\n                loading: false\n              }));\n              toast(\"Image upload failed. Try later.\");\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 11]]);\n    }));\n\n    return function handleImageRemove() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e) {\n      var _yield$axios$put, data;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              e.preventDefault();\n              _context4.prev = 1;\n              _context4.next = 4;\n              return axios.put(\"/api/course/\".concat(slug), _objectSpread(_objectSpread({}, values), {}, {\n                image: image\n              }));\n\n            case 4:\n              _yield$axios$put = _context4.sent;\n              data = _yield$axios$put.data;\n              toast(\"Course updated!\"); // router.push(\"/instructor\");\n\n              _context4.next = 12;\n              break;\n\n            case 9:\n              _context4.prev = 9;\n              _context4.t0 = _context4[\"catch\"](1);\n              toast(_context4.t0.response.data);\n\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[1, 9]]);\n    }));\n\n    return function handleSubmit(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handleDrag = function handleDrag(e, index) {\n    // console.log(\"ON DRAG => \", index);\n    e.dataTransfer.setData(\"itemIndex\", index);\n  };\n\n  var handleDrop = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e, index) {\n      var movingItemIndex, targetItemIndex, allLessons, movingItem, _yield$axios$put2, data;\n\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              // console.log(\"ON DROP => \", index);\n              movingItemIndex = e.dataTransfer.getData(\"itemIndex\");\n              targetItemIndex = index;\n              allLessons = values.lessons;\n              movingItem = allLessons[movingItemIndex]; // clicked/dragged item to re-order\n\n              allLessons.splice(movingItemIndex, 1); // remove 1 item from the given index\n\n              allLessons.splice(targetItemIndex, 0, movingItem); // push item after target item index\n\n              setValues(_objectSpread(_objectSpread({}, values), {}, {\n                lessons: _toConsumableArray(allLessons)\n              })); // save the new lessons order in db\n\n              _context5.next = 9;\n              return axios.put(\"/api/course/\".concat(slug), _objectSpread(_objectSpread({}, values), {}, {\n                image: image\n              }));\n\n            case 9:\n              _yield$axios$put2 = _context5.sent;\n              data = _yield$axios$put2.data;\n              // console.log(\"LESSONS REARRANGED RES => \", data);\n              toast(\"Lessons rearranged successfully\");\n\n            case 12:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function handleDrop(_x3, _x4) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var handleDelete = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(index) {\n      var answer, allLessons, removed, _yield$axios$put3, data;\n\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              answer = window.confirm(\"Are you sure you want to delete?\");\n\n              if (answer) {\n                _context6.next = 3;\n                break;\n              }\n\n              return _context6.abrupt(\"return\");\n\n            case 3:\n              allLessons = values.lessons;\n              removed = allLessons.splice(index, 1); // console.log(\"removed\", removed[0]._id);\n\n              setValues(_objectSpread(_objectSpread({}, values), {}, {\n                lessons: allLessons\n              })); // send request to server\n\n              _context6.next = 8;\n              return axios.put(\"/api/course/\".concat(slug, \"/\").concat(removed[0]._id));\n\n            case 8:\n              _yield$axios$put3 = _context6.sent;\n              data = _yield$axios$put3.data;\n              console.log(\"LESSON DELETED =>\", data);\n\n            case 11:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function handleDelete(_x5) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  /**\n   * lesson update functions\n   */\n\n\n  var handleVideo = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(e) {\n      var res, file, videoData, _yield$axios$post2, data;\n\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              if (!(current.video && current.video.Location)) {\n                _context7.next = 5;\n                break;\n              }\n\n              _context7.next = 3;\n              return axios.post(\"/api/course/video-remove/\".concat(values.instructor._id), current.video);\n\n            case 3:\n              res = _context7.sent;\n              console.log(\"REMOVED ===>\", res);\n\n            case 5:\n              // upload\n              file = e.target.files[0];\n              setUploadVideoButtonText(file.name);\n              setUploading(true); // send video as form data\n\n              videoData = new FormData();\n              videoData.append(\"video\", file);\n              videoData.append(\"courseId\", values._id); // save progress bar and send video as form data to backend\n\n              _context7.next = 13;\n              return axios.post(\"/api/course/video-upload/\".concat(values.instructor._id), videoData, {\n                onUploadProgress: function onUploadProgress(e) {\n                  return setProgress(Math.round(100 * e.loaded / e.total));\n                }\n              });\n\n            case 13:\n              _yield$axios$post2 = _context7.sent;\n              data = _yield$axios$post2.data;\n              console.log(data);\n              setCurrent(_objectSpread(_objectSpread({}, current), {}, {\n                video: data\n              }));\n              setUploading(false);\n\n            case 18:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    return function handleVideo(_x6) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var handleUpdateLesson = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(e) {\n      var _yield$axios$put4, data, arr, index;\n\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              // console.log(\"handle update lesson\");\n              e.preventDefault();\n              _context8.next = 3;\n              return axios.put(\"/api/course/lesson/\".concat(slug, \"/\").concat(current._id), current);\n\n            case 3:\n              _yield$axios$put4 = _context8.sent;\n              data = _yield$axios$put4.data;\n              setUploadVideoButtonText(\"Upload Video\");\n              setVisible(false); // update ui\n\n              if (data.ok) {\n                arr = values.lessons;\n                index = arr.findIndex(function (el) {\n                  return el._id === current._id;\n                });\n                arr[index] = current;\n                setValues(_objectSpread(_objectSpread({}, values), {}, {\n                  lessons: arr\n                }));\n                toast(\"Lesson updated\");\n              }\n\n            case 8:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function handleUpdateLesson(_x7) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(InstructorRoute, {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"jumbotron text-center square\",\n      children: \"Update Course\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pt-3 pb-3\",\n      children: /*#__PURE__*/_jsxDEV(CourseCreateForm, {\n        handleSubmit: handleSubmit,\n        handleImageRemove: handleImageRemove,\n        handleImage: handleImage,\n        handleChange: handleChange,\n        values: values,\n        setValues: setValues,\n        preview: preview,\n        uploadButtonText: uploadButtonText,\n        editPage: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row pb-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col lesson-list\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: [values && values.lessons && values.lessons.length, \" Lessons\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(List, {\n          onDragOver: function onDragOver(e) {\n            return e.preventDefault();\n          },\n          itemLayout: \"horizontal\",\n          dataSource: values && values.lessons,\n          renderItem: function renderItem(item, index) {\n            return /*#__PURE__*/_jsxDEV(Item, {\n              draggable: true,\n              onDragStart: function onDragStart(e) {\n                return handleDrag(e, index);\n              },\n              onDrop: function onDrop(e) {\n                return handleDrop(e, index);\n              },\n              children: [/*#__PURE__*/_jsxDEV(Item.Meta, {\n                onClick: function onClick() {\n                  setVisible(true);\n                  setCurrent(item);\n                },\n                avatar: /*#__PURE__*/_jsxDEV(Avatar, {\n                  children: index + 1\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 27\n                }, _this),\n                title: item.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 17\n              }, _this), /*#__PURE__*/_jsxDEV(DeleteOutlined, {\n                onClick: function onClick() {\n                  return handleDelete(index);\n                },\n                className: \"text-danger float-right\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 17\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 15\n            }, _this);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"Update lesson\",\n      centered: true,\n      visible: visible,\n      onCancel: function onCancel() {\n        return setVisible(false);\n      },\n      footer: null,\n      children: /*#__PURE__*/_jsxDEV(UpdateLessonForm, {\n        current: current,\n        setCurrent: setCurrent,\n        handleVideo: handleVideo,\n        handleUpdateLesson: handleUpdateLesson,\n        uploadVideoButtonText: uploadVideoButtonText,\n        progress: progress,\n        uploading: uploading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 205,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(CourseEdit, \"ZGRxBtEW1YEWiHnoKWNeH/OaPs8=\", false, function () {\n  return [useRouter];\n});\n\n_c = CourseEdit;\nexport default CourseEdit;\n\nvar _c;\n\n$RefreshReg$(_c, \"CourseEdit\");","map":{"version":3,"sources":["D:/TLCN/138_instructor_account_history_and_payouts/client/pages/instructor/course/edit/[slug].js"],"names":["useState","useEffect","axios","InstructorRoute","CourseCreateForm","Resizer","toast","useRouter","List","Avatar","Modal","DeleteOutlined","UpdateLessonForm","Item","CourseEdit","name","description","price","uploading","paid","category","loading","lessons","values","setValues","image","setImage","preview","setPreview","uploadButtonText","setUploadButtonText","visible","setVisible","current","setCurrent","uploadVideoButtonText","setUploadVideoButtonText","progress","setProgress","setUploading","router","slug","query","loadCourse","get","data","console","log","handleChange","e","target","value","handleImage","file","files","window","URL","createObjectURL","imageFileResizer","uri","post","handleImageRemove","res","handleSubmit","preventDefault","put","response","handleDrag","index","dataTransfer","setData","handleDrop","movingItemIndex","getData","targetItemIndex","allLessons","movingItem","splice","handleDelete","answer","confirm","removed","_id","handleVideo","video","Location","instructor","videoData","FormData","append","onUploadProgress","Math","round","loaded","total","handleUpdateLesson","ok","arr","findIndex","el","length","item","title"],"mappings":";;;;;;;;;;;;;;AAAA,SAASA,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,eAAP,MAA4B,+CAA5B;AACA,OAAOC,gBAAP,MAA6B,+CAA7B;AACA,OAAOC,OAAP,MAAoB,0BAApB;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,IAAT,EAAeC,MAAf,EAAuBC,KAAvB,QAAoC,MAApC;AACA,SAASC,cAAT,QAA+B,mBAA/B;AACA,OAAOC,gBAAP,MAA6B,+CAA7B;IAEQC,I,GAASL,I,CAATK,I;;AAER,IAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;AAAA;;AACvB;AADuB,kBAEKd,QAAQ,CAAC;AACnCe,IAAAA,IAAI,EAAE,EAD6B;AAEnCC,IAAAA,WAAW,EAAE,EAFsB;AAGnCC,IAAAA,KAAK,EAAE,MAH4B;AAInCC,IAAAA,SAAS,EAAE,KAJwB;AAKnCC,IAAAA,IAAI,EAAE,IAL6B;AAMnCC,IAAAA,QAAQ,EAAE,EANyB;AAOnCC,IAAAA,OAAO,EAAE,KAP0B;AAQnCC,IAAAA,OAAO,EAAE;AAR0B,GAAD,CAFb;AAAA,MAEhBC,MAFgB;AAAA,MAERC,SAFQ;;AAAA,mBAYGxB,QAAQ,CAAC,EAAD,CAZX;AAAA,MAYhByB,KAZgB;AAAA,MAYTC,QAZS;;AAAA,mBAaO1B,QAAQ,CAAC,EAAD,CAbf;AAAA,MAahB2B,OAbgB;AAAA,MAaPC,UAbO;;AAAA,mBAcyB5B,QAAQ,CAAC,cAAD,CAdjC;AAAA,MAchB6B,gBAdgB;AAAA,MAcEC,mBAdF,kBAgBvB;;;AAhBuB,mBAiBO9B,QAAQ,CAAC,KAAD,CAjBf;AAAA,MAiBhB+B,OAjBgB;AAAA,MAiBPC,UAjBO;;AAAA,mBAkBOhC,QAAQ,CAAC,EAAD,CAlBf;AAAA,MAkBhBiC,OAlBgB;AAAA,MAkBPC,UAlBO;;AAAA,mBAmBmClC,QAAQ,CAChE,cADgE,CAnB3C;AAAA,MAmBhBmC,qBAnBgB;AAAA,MAmBOC,wBAnBP;;AAAA,mBAsBSpC,QAAQ,CAAC,CAAD,CAtBjB;AAAA,MAsBhBqC,QAtBgB;AAAA,MAsBNC,WAtBM;;AAAA,mBAuBWtC,QAAQ,CAAC,KAAD,CAvBnB;AAAA,MAuBhBkB,SAvBgB;AAAA,MAuBLqB,YAvBK,kBAyBvB;;;AACA,MAAMC,MAAM,GAAGjC,SAAS,EAAxB;AA1BuB,MA2BfkC,IA3Be,GA2BND,MAAM,CAACE,KA3BD,CA2BfD,IA3Be;AA6BvBxC,EAAAA,SAAS,CAAC,YAAM;AACd0C,IAAAA,UAAU;AACX,GAFQ,EAEN,CAACF,IAAD,CAFM,CAAT;;AAIA,MAAME,UAAU;AAAA,wEAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACMzC,KAAK,CAAC0C,GAAN,uBAAyBH,IAAzB,EADN;;AAAA;AAAA;AACTI,cAAAA,IADS,oBACTA,IADS;AAEjBC,cAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACA,kBAAIA,IAAJ,EAAUrB,SAAS,CAACqB,IAAD,CAAT;AACV,kBAAIA,IAAI,IAAIA,IAAI,CAACpB,KAAjB,EAAwBC,QAAQ,CAACmB,IAAI,CAACpB,KAAN,CAAR;;AAJP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAVkB,UAAU;AAAA;AAAA;AAAA,KAAhB;;AAOA,MAAMK,YAAY,GAAG,SAAfA,YAAe,CAACC,CAAD,EAAO;AAC1BzB,IAAAA,SAAS,iCAAMD,MAAN,2BAAe0B,CAAC,CAACC,MAAF,CAASnC,IAAxB,EAA+BkC,CAAC,CAACC,MAAF,CAASC,KAAxC,GAAT;AACD,GAFD;;AAIA,MAAMC,WAAW,GAAG,SAAdA,WAAc,CAACH,CAAD,EAAO;AACzB,QAAII,IAAI,GAAGJ,CAAC,CAACC,MAAF,CAASI,KAAT,CAAe,CAAf,CAAX;AACA1B,IAAAA,UAAU,CAAC2B,MAAM,CAACC,GAAP,CAAWC,eAAX,CAA2BJ,IAA3B,CAAD,CAAV;AACAvB,IAAAA,mBAAmB,CAACuB,IAAI,CAACtC,IAAN,CAAnB;AACAS,IAAAA,SAAS,iCAAMD,MAAN;AAAcF,MAAAA,OAAO,EAAE;AAAvB,OAAT,CAJyB,CAKzB;;AACAhB,IAAAA,OAAO,CAACqD,gBAAR,CAAyBL,IAAzB,EAA+B,GAA/B,EAAoC,GAApC,EAAyC,MAAzC,EAAiD,GAAjD,EAAsD,CAAtD;AAAA,2EAAyD,kBAAOM,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEhCzD,KAAK,CAAC0D,IAAN,CAAW,0BAAX,EAAuC;AAC1DnC,kBAAAA,KAAK,EAAEkC;AADmD,iBAAvC,CAFgC;;AAAA;AAAA;AAE/Cd,gBAAAA,IAF+C,qBAE/CA,IAF+C;AAKrDC,gBAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,IAA9B,EALqD,CAMrD;;AACAnB,gBAAAA,QAAQ,CAACmB,IAAD,CAAR;AACArB,gBAAAA,SAAS,iCAAMD,MAAN;AAAcF,kBAAAA,OAAO,EAAE;AAAvB,mBAAT;AARqD;AAAA;;AAAA;AAAA;AAAA;AAUrDyB,gBAAAA,OAAO,CAACC,GAAR;AACAvB,gBAAAA,SAAS,iCAAMD,MAAN;AAAcF,kBAAAA,OAAO,EAAE;AAAvB,mBAAT;AACAf,gBAAAA,KAAK,CAAC,iCAAD,CAAL;;AAZqD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAzD;;AAAA;AAAA;AAAA;AAAA;AAeD,GArBD;;AAuBA,MAAMuD,iBAAiB;AAAA,yEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEtB;AACArC,cAAAA,SAAS,iCAAMD,MAAN;AAAcF,gBAAAA,OAAO,EAAE;AAAvB,iBAAT;AAHsB;AAAA,qBAIJnB,KAAK,CAAC0D,IAAN,CAAW,0BAAX,EAAuC;AAAEnC,gBAAAA,KAAK,EAALA;AAAF,eAAvC,CAJI;;AAAA;AAIhBqC,cAAAA,GAJgB;AAKtBpC,cAAAA,QAAQ,CAAC,EAAD,CAAR;AACAE,cAAAA,UAAU,CAAC,EAAD,CAAV;AACAE,cAAAA,mBAAmB,CAAC,cAAD,CAAnB;AACAN,cAAAA,SAAS,iCAAMD,MAAN;AAAcF,gBAAAA,OAAO,EAAE;AAAvB,iBAAT;AARsB;AAAA;;AAAA;AAAA;AAAA;AAUtByB,cAAAA,OAAO,CAACC,GAAR;AACAvB,cAAAA,SAAS,iCAAMD,MAAN;AAAcF,gBAAAA,OAAO,EAAE;AAAvB,iBAAT;AACAf,cAAAA,KAAK,CAAC,iCAAD,CAAL;;AAZsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAjBuD,iBAAiB;AAAA;AAAA;AAAA,KAAvB;;AAgBA,MAAME,YAAY;AAAA,yEAAG,kBAAOd,CAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACnBA,cAAAA,CAAC,CAACe,cAAF;AADmB;AAAA;AAAA,qBAIM9D,KAAK,CAAC+D,GAAN,uBAAyBxB,IAAzB,mCAClBlB,MADkB;AAErBE,gBAAAA,KAAK,EAALA;AAFqB,iBAJN;;AAAA;AAAA;AAIToB,cAAAA,IAJS,oBAITA,IAJS;AAQjBvC,cAAAA,KAAK,CAAC,iBAAD,CAAL,CARiB,CASjB;;AATiB;AAAA;;AAAA;AAAA;AAAA;AAWjBA,cAAAA,KAAK,CAAC,aAAI4D,QAAJ,CAAarB,IAAd,CAAL;;AAXiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAZkB,YAAY;AAAA;AAAA;AAAA,KAAlB;;AAeA,MAAMI,UAAU,GAAG,SAAbA,UAAa,CAAClB,CAAD,EAAImB,KAAJ,EAAc;AAC/B;AACAnB,IAAAA,CAAC,CAACoB,YAAF,CAAeC,OAAf,CAAuB,WAAvB,EAAoCF,KAApC;AACD,GAHD;;AAKA,MAAMG,UAAU;AAAA,yEAAG,kBAAOtB,CAAP,EAAUmB,KAAV;AAAA;;AAAA;AAAA;AAAA;AAAA;AACjB;AAEMI,cAAAA,eAHW,GAGOvB,CAAC,CAACoB,YAAF,CAAeI,OAAf,CAAuB,WAAvB,CAHP;AAIXC,cAAAA,eAJW,GAION,KAJP;AAKbO,cAAAA,UALa,GAKApD,MAAM,CAACD,OALP;AAObsD,cAAAA,UAPa,GAOAD,UAAU,CAACH,eAAD,CAPV,EAO6B;;AAC9CG,cAAAA,UAAU,CAACE,MAAX,CAAkBL,eAAlB,EAAmC,CAAnC,EARiB,CAQsB;;AACvCG,cAAAA,UAAU,CAACE,MAAX,CAAkBH,eAAlB,EAAmC,CAAnC,EAAsCE,UAAtC,EATiB,CASkC;;AAEnDpD,cAAAA,SAAS,iCAAMD,MAAN;AAAcD,gBAAAA,OAAO,qBAAMqD,UAAN;AAArB,iBAAT,CAXiB,CAYjB;;AAZiB;AAAA,qBAaMzE,KAAK,CAAC+D,GAAN,uBAAyBxB,IAAzB,mCAClBlB,MADkB;AAErBE,gBAAAA,KAAK,EAALA;AAFqB,iBAbN;;AAAA;AAAA;AAaToB,cAAAA,IAbS,qBAaTA,IAbS;AAiBjB;AACAvC,cAAAA,KAAK,CAAC,iCAAD,CAAL;;AAlBiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAViE,UAAU;AAAA;AAAA;AAAA,KAAhB;;AAqBA,MAAMO,YAAY;AAAA,yEAAG,kBAAOV,KAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACbW,cAAAA,MADa,GACJxB,MAAM,CAACyB,OAAP,CAAe,kCAAf,CADI;;AAAA,kBAEdD,MAFc;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAGfJ,cAAAA,UAHe,GAGFpD,MAAM,CAACD,OAHL;AAIb2D,cAAAA,OAJa,GAIHN,UAAU,CAACE,MAAX,CAAkBT,KAAlB,EAAyB,CAAzB,CAJG,EAKnB;;AACA5C,cAAAA,SAAS,iCAAMD,MAAN;AAAcD,gBAAAA,OAAO,EAAEqD;AAAvB,iBAAT,CANmB,CAOnB;;AAPmB;AAAA,qBAQIzE,KAAK,CAAC+D,GAAN,uBAAyBxB,IAAzB,cAAiCwC,OAAO,CAAC,CAAD,CAAP,CAAWC,GAA5C,EARJ;;AAAA;AAAA;AAQXrC,cAAAA,IARW,qBAQXA,IARW;AASnBC,cAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCF,IAAjC;;AATmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAZiC,YAAY;AAAA;AAAA;AAAA,KAAlB;AAYA;AACF;AACA;;;AAEE,MAAMK,WAAW;AAAA,yEAAG,kBAAOlC,CAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEdhB,OAAO,CAACmD,KAAR,IAAiBnD,OAAO,CAACmD,KAAR,CAAcC,QAFjB;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAGEnF,KAAK,CAAC0D,IAAN,oCACYrC,MAAM,CAAC+D,UAAP,CAAkBJ,GAD9B,GAEhBjD,OAAO,CAACmD,KAFQ,CAHF;;AAAA;AAGVtB,cAAAA,GAHU;AAOhBhB,cAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4Be,GAA5B;;AAPgB;AASlB;AACMT,cAAAA,IAVY,GAULJ,CAAC,CAACC,MAAF,CAASI,KAAT,CAAe,CAAf,CAVK;AAWlBlB,cAAAA,wBAAwB,CAACiB,IAAI,CAACtC,IAAN,CAAxB;AACAwB,cAAAA,YAAY,CAAC,IAAD,CAAZ,CAZkB,CAalB;;AACMgD,cAAAA,SAdY,GAcA,IAAIC,QAAJ,EAdA;AAelBD,cAAAA,SAAS,CAACE,MAAV,CAAiB,OAAjB,EAA0BpC,IAA1B;AACAkC,cAAAA,SAAS,CAACE,MAAV,CAAiB,UAAjB,EAA6BlE,MAAM,CAAC2D,GAApC,EAhBkB,CAiBlB;;AAjBkB;AAAA,qBAkBKhF,KAAK,CAAC0D,IAAN,oCACOrC,MAAM,CAAC+D,UAAP,CAAkBJ,GADzB,GAErBK,SAFqB,EAGrB;AACEG,gBAAAA,gBAAgB,EAAE,0BAACzC,CAAD;AAAA,yBAChBX,WAAW,CAACqD,IAAI,CAACC,KAAL,CAAY,MAAM3C,CAAC,CAAC4C,MAAT,GAAmB5C,CAAC,CAAC6C,KAAhC,CAAD,CADK;AAAA;AADpB,eAHqB,CAlBL;;AAAA;AAAA;AAkBVjD,cAAAA,IAlBU,sBAkBVA,IAlBU;AA0BlBC,cAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AACAX,cAAAA,UAAU,iCAAMD,OAAN;AAAemD,gBAAAA,KAAK,EAAEvC;AAAtB,iBAAV;AACAN,cAAAA,YAAY,CAAC,KAAD,CAAZ;;AA5BkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAX4C,WAAW;AAAA;AAAA;AAAA,KAAjB;;AA+BA,MAAMY,kBAAkB;AAAA,yEAAG,kBAAO9C,CAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACzB;AACAA,cAAAA,CAAC,CAACe,cAAF;AAFyB;AAAA,qBAGF9D,KAAK,CAAC+D,GAAN,8BACCxB,IADD,cACSR,OAAO,CAACiD,GADjB,GAErBjD,OAFqB,CAHE;;AAAA;AAAA;AAGjBY,cAAAA,IAHiB,qBAGjBA,IAHiB;AAOzBT,cAAAA,wBAAwB,CAAC,cAAD,CAAxB;AACAJ,cAAAA,UAAU,CAAC,KAAD,CAAV,CARyB,CASzB;;AACA,kBAAIa,IAAI,CAACmD,EAAT,EAAa;AACPC,gBAAAA,GADO,GACD1E,MAAM,CAACD,OADN;AAEL8C,gBAAAA,KAFK,GAEG6B,GAAG,CAACC,SAAJ,CAAc,UAACC,EAAD;AAAA,yBAAQA,EAAE,CAACjB,GAAH,KAAWjD,OAAO,CAACiD,GAA3B;AAAA,iBAAd,CAFH;AAGXe,gBAAAA,GAAG,CAAC7B,KAAD,CAAH,GAAanC,OAAb;AACAT,gBAAAA,SAAS,iCAAMD,MAAN;AAAcD,kBAAAA,OAAO,EAAE2E;AAAvB,mBAAT;AACA3F,gBAAAA,KAAK,CAAC,gBAAD,CAAL;AACD;;AAhBwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAlByF,kBAAkB;AAAA;AAAA;AAAA,KAAxB;;AAmBA,sBACE,QAAC,eAAD;AAAA,4BACE;AAAI,MAAA,SAAS,EAAC,8BAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAGE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA,6BACE,QAAC,gBAAD;AACE,QAAA,YAAY,EAAEhC,YADhB;AAEE,QAAA,iBAAiB,EAAEF,iBAFrB;AAGE,QAAA,WAAW,EAAET,WAHf;AAIE,QAAA,YAAY,EAAEJ,YAJhB;AAKE,QAAA,MAAM,EAAEzB,MALV;AAME,QAAA,SAAS,EAAEC,SANb;AAOE,QAAA,OAAO,EAAEG,OAPX;AAQE,QAAA,gBAAgB,EAAEE,gBARpB;AASE,QAAA,QAAQ,EAAE;AATZ;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,aAHF,eAoBE;AAAA;AAAA;AAAA;AAAA,aApBF,eAsBE;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA,6BACE;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA,gCACE;AAAA,qBAAKN,MAAM,IAAIA,MAAM,CAACD,OAAjB,IAA4BC,MAAM,CAACD,OAAP,CAAe8E,MAAhD;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,eAEE,QAAC,IAAD;AACE,UAAA,UAAU,EAAE,oBAACnD,CAAD;AAAA,mBAAOA,CAAC,CAACe,cAAF,EAAP;AAAA,WADd;AAEE,UAAA,UAAU,EAAC,YAFb;AAGE,UAAA,UAAU,EAAEzC,MAAM,IAAIA,MAAM,CAACD,OAH/B;AAIE,UAAA,UAAU,EAAE,oBAAC+E,IAAD,EAAOjC,KAAP;AAAA,gCACV,QAAC,IAAD;AACE,cAAA,SAAS,MADX;AAEE,cAAA,WAAW,EAAE,qBAACnB,CAAD;AAAA,uBAAOkB,UAAU,CAAClB,CAAD,EAAImB,KAAJ,CAAjB;AAAA,eAFf;AAGE,cAAA,MAAM,EAAE,gBAACnB,CAAD;AAAA,uBAAOsB,UAAU,CAACtB,CAAD,EAAImB,KAAJ,CAAjB;AAAA,eAHV;AAAA,sCAKE,QAAC,IAAD,CAAM,IAAN;AACE,gBAAA,OAAO,EAAE,mBAAM;AACbpC,kBAAAA,UAAU,CAAC,IAAD,CAAV;AACAE,kBAAAA,UAAU,CAACmE,IAAD,CAAV;AACD,iBAJH;AAKE,gBAAA,MAAM,eAAE,QAAC,MAAD;AAAA,4BAASjC,KAAK,GAAG;AAAjB;AAAA;AAAA;AAAA;AAAA,yBALV;AAME,gBAAA,KAAK,EAAEiC,IAAI,CAACC;AANd;AAAA;AAAA;AAAA;AAAA,uBALF,eAcE,QAAC,cAAD;AACE,gBAAA,OAAO,EAAE;AAAA,yBAAMxB,YAAY,CAACV,KAAD,CAAlB;AAAA,iBADX;AAEE,gBAAA,SAAS,EAAC;AAFZ;AAAA;AAAA;AAAA;AAAA,uBAdF;AAAA;AAAA;AAAA;AAAA;AAAA,qBADU;AAAA;AAJd;AAAA;AAAA;AAAA;AAAA,iBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,aAtBF,eAsDE,QAAC,KAAD;AACE,MAAA,KAAK,EAAC,eADR;AAEE,MAAA,QAAQ,MAFV;AAGE,MAAA,OAAO,EAAErC,OAHX;AAIE,MAAA,QAAQ,EAAE;AAAA,eAAMC,UAAU,CAAC,KAAD,CAAhB;AAAA,OAJZ;AAKE,MAAA,MAAM,EAAE,IALV;AAAA,6BAOE,QAAC,gBAAD;AACE,QAAA,OAAO,EAAEC,OADX;AAEE,QAAA,UAAU,EAAEC,UAFd;AAGE,QAAA,WAAW,EAAEiD,WAHf;AAIE,QAAA,kBAAkB,EAAEY,kBAJtB;AAKE,QAAA,qBAAqB,EAAE5D,qBALzB;AAME,QAAA,QAAQ,EAAEE,QANZ;AAOE,QAAA,SAAS,EAAEnB;AAPb;AAAA;AAAA;AAAA;AAAA;AAPF;AAAA;AAAA;AAAA;AAAA,aAtDF;AAAA;AAAA;AAAA;AAAA;AAAA,WADF;AA2ED,CAzQD;;GAAMJ,U;UA0BWP,S;;;KA1BXO,U;AA2QN,eAAeA,UAAf","sourcesContent":["import { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport InstructorRoute from \"../../../../components/routes/InstructorRoute\";\nimport CourseCreateForm from \"../../../../components/forms/CourseCreateForm\";\nimport Resizer from \"react-image-file-resizer\";\nimport { toast } from \"react-toastify\";\nimport { useRouter } from \"next/router\";\nimport { List, Avatar, Modal } from \"antd\";\nimport { DeleteOutlined } from \"@ant-design/icons\";\nimport UpdateLessonForm from \"../../../../components/forms/UpdateLessonForm\";\n\nconst { Item } = List;\n\nconst CourseEdit = () => {\n  // state\n  const [values, setValues] = useState({\n    name: \"\",\n    description: \"\",\n    price: \"9.99\",\n    uploading: false,\n    paid: true,\n    category: \"\",\n    loading: false,\n    lessons: [],\n  });\n  const [image, setImage] = useState({});\n  const [preview, setPreview] = useState(\"\");\n  const [uploadButtonText, setUploadButtonText] = useState(\"Upload Image\");\n\n  // state for lessons update\n  const [visible, setVisible] = useState(false);\n  const [current, setCurrent] = useState({});\n  const [uploadVideoButtonText, setUploadVideoButtonText] = useState(\n    \"Upload Video\"\n  );\n  const [progress, setProgress] = useState(0);\n  const [uploading, setUploading] = useState(false);\n\n  // router\n  const router = useRouter();\n  const { slug } = router.query;\n\n  useEffect(() => {\n    loadCourse();\n  }, [slug]);\n\n  const loadCourse = async () => {\n    const { data } = await axios.get(`/api/course/${slug}`);\n    console.log(data);\n    if (data) setValues(data);\n    if (data && data.image) setImage(data.image);\n  };\n\n  const handleChange = (e) => {\n    setValues({ ...values, [e.target.name]: e.target.value });\n  };\n\n  const handleImage = (e) => {\n    let file = e.target.files[0];\n    setPreview(window.URL.createObjectURL(file));\n    setUploadButtonText(file.name);\n    setValues({ ...values, loading: true });\n    // resize\n    Resizer.imageFileResizer(file, 720, 500, \"JPEG\", 100, 0, async (uri) => {\n      try {\n        let { data } = await axios.post(\"/api/course/upload-image\", {\n          image: uri,\n        });\n        console.log(\"IMAGE UPLOADED\", data);\n        // set image in the state\n        setImage(data);\n        setValues({ ...values, loading: false });\n      } catch (err) {\n        console.log(err);\n        setValues({ ...values, loading: false });\n        toast(\"Image upload failed. Try later.\");\n      }\n    });\n  };\n\n  const handleImageRemove = async () => {\n    try {\n      // console.log(values);\n      setValues({ ...values, loading: true });\n      const res = await axios.post(\"/api/course/remove-image\", { image });\n      setImage({});\n      setPreview(\"\");\n      setUploadButtonText(\"Upload Image\");\n      setValues({ ...values, loading: false });\n    } catch (err) {\n      console.log(err);\n      setValues({ ...values, loading: false });\n      toast(\"Image upload failed. Try later.\");\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    try {\n      // console.log(values);\n      const { data } = await axios.put(`/api/course/${slug}`, {\n        ...values,\n        image,\n      });\n      toast(\"Course updated!\");\n      // router.push(\"/instructor\");\n    } catch (err) {\n      toast(err.response.data);\n    }\n  };\n\n  const handleDrag = (e, index) => {\n    // console.log(\"ON DRAG => \", index);\n    e.dataTransfer.setData(\"itemIndex\", index);\n  };\n\n  const handleDrop = async (e, index) => {\n    // console.log(\"ON DROP => \", index);\n\n    const movingItemIndex = e.dataTransfer.getData(\"itemIndex\");\n    const targetItemIndex = index;\n    let allLessons = values.lessons;\n\n    let movingItem = allLessons[movingItemIndex]; // clicked/dragged item to re-order\n    allLessons.splice(movingItemIndex, 1); // remove 1 item from the given index\n    allLessons.splice(targetItemIndex, 0, movingItem); // push item after target item index\n\n    setValues({ ...values, lessons: [...allLessons] });\n    // save the new lessons order in db\n    const { data } = await axios.put(`/api/course/${slug}`, {\n      ...values,\n      image,\n    });\n    // console.log(\"LESSONS REARRANGED RES => \", data);\n    toast(\"Lessons rearranged successfully\");\n  };\n\n  const handleDelete = async (index) => {\n    const answer = window.confirm(\"Are you sure you want to delete?\");\n    if (!answer) return;\n    let allLessons = values.lessons;\n    const removed = allLessons.splice(index, 1);\n    // console.log(\"removed\", removed[0]._id);\n    setValues({ ...values, lessons: allLessons });\n    // send request to server\n    const { data } = await axios.put(`/api/course/${slug}/${removed[0]._id}`);\n    console.log(\"LESSON DELETED =>\", data);\n  };\n\n  /**\n   * lesson update functions\n   */\n\n  const handleVideo = async (e) => {\n    // remove previous video\n    if (current.video && current.video.Location) {\n      const res = await axios.post(\n        `/api/course/video-remove/${values.instructor._id}`,\n        current.video\n      );\n      console.log(\"REMOVED ===>\", res);\n    }\n    // upload\n    const file = e.target.files[0];\n    setUploadVideoButtonText(file.name);\n    setUploading(true);\n    // send video as form data\n    const videoData = new FormData();\n    videoData.append(\"video\", file);\n    videoData.append(\"courseId\", values._id);\n    // save progress bar and send video as form data to backend\n    const { data } = await axios.post(\n      `/api/course/video-upload/${values.instructor._id}`,\n      videoData,\n      {\n        onUploadProgress: (e) =>\n          setProgress(Math.round((100 * e.loaded) / e.total)),\n      }\n    );\n    console.log(data);\n    setCurrent({ ...current, video: data });\n    setUploading(false);\n  };\n\n  const handleUpdateLesson = async (e) => {\n    // console.log(\"handle update lesson\");\n    e.preventDefault();\n    const { data } = await axios.put(\n      `/api/course/lesson/${slug}/${current._id}`,\n      current\n    );\n    setUploadVideoButtonText(\"Upload Video\");\n    setVisible(false);\n    // update ui\n    if (data.ok) {\n      let arr = values.lessons;\n      const index = arr.findIndex((el) => el._id === current._id);\n      arr[index] = current;\n      setValues({ ...values, lessons: arr });\n      toast(\"Lesson updated\");\n    }\n  };\n\n  return (\n    <InstructorRoute>\n      <h1 className=\"jumbotron text-center square\">Update Course</h1>\n      {/* {JSON.stringify(values)} */}\n      <div className=\"pt-3 pb-3\">\n        <CourseCreateForm\n          handleSubmit={handleSubmit}\n          handleImageRemove={handleImageRemove}\n          handleImage={handleImage}\n          handleChange={handleChange}\n          values={values}\n          setValues={setValues}\n          preview={preview}\n          uploadButtonText={uploadButtonText}\n          editPage={true}\n        />\n      </div>\n      {/* <pre>{JSON.stringify(values, null, 4)}</pre>\n      <hr />\n      <pre>{JSON.stringify(image, null, 4)}</pre> */}\n\n      <hr />\n\n      <div className=\"row pb-5\">\n        <div className=\"col lesson-list\">\n          <h4>{values && values.lessons && values.lessons.length} Lessons</h4>\n          <List\n            onDragOver={(e) => e.preventDefault()}\n            itemLayout=\"horizontal\"\n            dataSource={values && values.lessons}\n            renderItem={(item, index) => (\n              <Item\n                draggable\n                onDragStart={(e) => handleDrag(e, index)}\n                onDrop={(e) => handleDrop(e, index)}\n              >\n                <Item.Meta\n                  onClick={() => {\n                    setVisible(true);\n                    setCurrent(item);\n                  }}\n                  avatar={<Avatar>{index + 1}</Avatar>}\n                  title={item.title}\n                ></Item.Meta>\n\n                <DeleteOutlined\n                  onClick={() => handleDelete(index)}\n                  className=\"text-danger float-right\"\n                />\n              </Item>\n            )}\n          ></List>\n        </div>\n      </div>\n\n      <Modal\n        title=\"Update lesson\"\n        centered\n        visible={visible}\n        onCancel={() => setVisible(false)}\n        footer={null}\n      >\n        <UpdateLessonForm\n          current={current}\n          setCurrent={setCurrent}\n          handleVideo={handleVideo}\n          handleUpdateLesson={handleUpdateLesson}\n          uploadVideoButtonText={uploadVideoButtonText}\n          progress={progress}\n          uploading={uploading}\n        />\n        {/* <pre>{JSON.stringify(current, null, 4)}</pre> */}\n      </Modal>\n    </InstructorRoute>\n  );\n};\n\nexport default CourseEdit;\n"]},"metadata":{},"sourceType":"module"}